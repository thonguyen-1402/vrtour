<!doctype html>
<html>
  <head>
    <script src="https://aframe.io/releases/0.9.2/aframe.min.js"></script>
    <link href="https://fonts.googleapis.com/css?family=Roboto&display=swap" rel="stylesheet">
    <script src="https://supereggbert.github.io/aframe-htmlembed-component/dist/build.js"></script>
    <link href="https://fonts.googleapis.com/css?family=Roboto&display=swap" rel="stylesheet">

    <link rel="stylesheet" href="style.css">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <script src="https://unpkg.com/aframe-environment-component/dist/aframe-environment-component.min.js"></script>
    <script src="https://unpkg.com/aframe-event-set-component@4.2.1/dist/aframe-event-set-component.min.js"></script>
    <script src="https://unpkg.com/three@0.131.3/examples/js/loaders/TDSLoader.js"></script>
    <script src="https://unpkg.com/aframe-animation-component@^4.1.2/dist/aframe-animation-component.min.js"></script>
    <script src="./index.js"></script>
    <title> HUST CAMPUS TOUR </title>

  <!--------------------------------------------------------------------------------------->
  <!-- <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
  integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
  integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
  crossorigin="anonymous"></script>
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" rel="stylesheet"> -->
</head>
   <style>
    body{
      font-family: 'Roboto', sans-serif;
      text-shadow: 0px 0px 10px #00d2ff;
      color: #fff;
      font-size: 32px;
      margin: 0;
        height: 100vh;
        display: flex;
        justify-content: center;
        align-items: center;
          }

    h1{
      font-size: 52px;
    }
    .dark{
      background-color: rgba(0,0,0,0.2);
      border-radius:50px;  
      background-repeat: no-repeat;
      background-position: bottom right;
      padding: 40px;
    }
    .main{
      width: 1024px;
      height: 768px;
      overflow: hidden;
    }
    .menu{
      width: 256px;
      height: 768px;
      text-align: center;
    }
    .menu ul{
      list-style-type: none;
      margin: 0;
      padding: 0;
    }
    a.button{
      display: inline-block;
      width: 100%;
      border-radius: 20px;
      background-color: #000;
      color: #fff;
      text-decoration: none;
      text-align: center;
      padding: 10px 0;
      margin-bottom: 20px;
    }
    a.button:hover{
      background-color: #fff;
      color: #888;
    }
    a.button:active{
      background-color: #fff;
      color: #888;
      box-shadow: 0px 0px 50px #00d2ff;
    }
    /* a.imgLink{
      width: 100%;
      border-radius: 20px;
      color: #fff;
      text-decoration: none;
      text-align: center;
      padding: 10px 0;
      margin-bottom: 20px;
      background-color: #444;
      border: 3px solid #444;
      text-shadow: none;
      display: block;
    }
    a.imgLink:hover{
      border: 3px solid #fff;
      background-color: #444;
    } */
    .code{
      white-space: pre;
      font-size: 0.7em;
      background-color: #000;
      margin-bottom: 30px;
    }
    .next,.prev{
      position: absolute;
      bottom: 0px;
      right: 30px;
      display: inline-block;
      width: auto !important;
      padding: 20px 30px !important;
    }
    .prev{
      right: auto;
      left: 30px;
    }
    #page1{
      position: relative;
      height: 100%;
    }
    #page2, #page3, #page4{
      display: none;
      position: relative;
      height: 100%;
    }
    .slide{
      height:100%;
    }
    .slide:target #page1{
      display: none;
    }
    #slide2:target #page2{
      display: block;
    }
    #slide3:target #page3{
      display: block;
    }
    #slide4:target #page4{
      display: block;
    }
    #page4 ul{
      list-style-type: square;
      font-size: 0.8em;
    }
    </style>
    <script>
    AFRAME.registerComponent('showbutton', {
      schema: {
        'target': {type: 'selector'},
      },
      init: function () {
        var show=false;    
        this.el.addEventListener("click",()=>{
          if(show){
            this.data.target.setAttribute("visible","false");
            this.el.querySelector("a").innerHTML="Show Box";
          }else{
            this.data.target.setAttribute("visible","true");
            this.el.querySelector("a").innerHTML="Hide Box";
          }
          show=!show;
        });
      }
    });
    </script>
  </head>
  <body>
    <div id="slide2" class="slide">
    <div id="slide3" class="slide">
    <div id="slide4" class="slide">
     
    <a-scene id="loading" stats loading-screen="dotsColor: #B8001F; backgroundColor: #FCFAEE"; XRMode: xr>

      <a-assets>

        <img id="Nguyen_lab#1" src="assets/Nguyen_lab/Nguyen_lab_1.JPG" />
        <img id="Nguyen_lab#2" src="assets/Nguyen_lab/Nguyen2.JPG" />
        <img id="Nguyen_lab#3" src="assets/Nguyen_lab/Nguyen3.JPG" />
        <img id="arrow" src="assets/yajirusi.png" />
        <img id="hall_Nguyenlab" src="assets/hall/hall_Nguyenlab.JPG" />
        <img id="close" src="assets/close.png" />
        <img id="info" src="assets/info.png" />
        <img id = "close" src ="assets/close.png"/>
        <img id ="language" src ="assets/language.png"/>

        <img id="buff" src="#arrow"> <!--probably some random bugs-->
        <a-entity id="buffer"></a-entity>
        <a-mixin id="bounce"
            animation__customevent="property: components.material.material.color; type: color; from: red; to: blue; startEvents: trigger; dur: 500"></a-mixin>

    </a-assets>

      <a-entity id="closepop_up" src="#close" class="collidable" position="0 0 0" rotation="0 0 0"
      move-controller visible="false"></a-entity>

  <!-- <a-entity position=" 0 2 -1" id="text1" geometry="primitive:plane; width:0; height:0"
      material="color : white; opacity : 0.5" visible="false" text="width:0.7; anchor: center; width: 1.5; color: black; wrapCount : 50; value : Trường Đại học Bách Khoa (ĐHQG TP.HCM) là một trong những trường đại học hàng đầu tại Việt Nam, nổi bật trong các lĩnh vực khoa học kỹ thuật, 
công nghệ, và quản lý. Trường cung cấp các chương trình đào tạo đa dạng, từ đại học đến sau đại học, 
và luôn đi đầu trong nghiên cứu khoa học và ứng dụng công nghệ. Với đội ngũ giảng viên chất lượng, 
cơ sở vật chất hiện đại, Đại học Bách Khoa là điểm đến của nhiều thế hệ sinh viên ưu tú."></a-entity> -->

<a-image id="lanb" src="#language" class="collidable" position="-0.8 1.5 -1"
rotation="0 0 0" scale=" 0.1 0.1 0" opacity="0/8" visible= "true" move-controller></a-image>

<a-image id="infob" src="#info" class="collidable" position="-0.8 1.4 -1"
      rotation="0 0 0" scale=" 0.1 0.1 0" opacity="0.8" visible= "true" move-controller></a-image>
  
  <a-image id="closeb" src="#close" class="collidable" position="-0.8 1.4 -1"
      rotation="0 0 0" scale=" 0.1 0.1 0" opacity="0.8" visible= "false" move-controller></a-image>
  
  <a-image id ="closeb" src ="#closeb" class= "colldable" positino ="-0.4 1.3 -1" ></a-image>
  <a-image id="right" src="#arrow" class="collidable" position="0 10 11 " rotation="0 0 50"
      scale="3 0.5 1" opacity="0.8" visible=false move-controller></a-image>

  <a-image id="left" src="#arrow" class="collidable" position="11 11 11" rotation="0 0 0"
      scale="3 0.5 0" opacity="0.8" visible=false move-controller></a-image>

  <a-image id="forward" src="#arrow" class="collidable" position="0 1 -1" rotation="0 0 0"
      scale=" 3 0.5 0" opacity="0.8" visible=true move-controller></a-image>

  <a-image id="back" src="#arrow" class="collidable" position="0 4 4" rotation="0 0 0"
      scale="3 0.5 0" opacity="0.8" visible=false move-controller></a-image>
  <!-- Sky element -->

  <a-sky id="sky" src="#hall_Nguyenlab" rotation="0 -90 0"></a-sky>

 

   <a-entity id="cameraRig">
    <a-camera id="camera">
      <a-entity cursor="rayOrigin: mouse"></a-entity> <!--ray casting from the mouse to the entity -->
      <a-entity id="right controller" laser-controls="hand:right" raycaster="objects:.collidable"
          right-controller></a-entity>
      <a-entity id="left controller" laser-controls="hand:left" raycaster="objects:.collidable"
       left-controller></a-entity>

    </a-camera>
      <!--------------------------------------------------------------------------------->

      </a-entity>
      <a-entity id="main" class="screen dark main" htmlembed="ppu:256" position="0 2.5 -5" visible = "false">
        <div id="page1">
          <h1>chinese letter</h1>
          <p>HTML Embed is a component created for A-Frame. The HTML Embed component allows for arbitrary html to be inserted into your aframe scene. It allows you to update the display within A-Frame simply by manipulating the DOM as you normally would. 
          </p>
          <p>
      In addition to rendering the html to the A-Frame scene it allows for interaction. Most css pseudo selectors such as hover, active, focus and target should work with interactivity enabled without any modifications to your css. Mouse events can be attached to the html elements as usual. </p>
      <a href="#slide2" class="button next">Next Page</a>
         </div>
        <div id="page2">
          <h1>chinese letter blablabal</h1>
          <p>HTML Embed allows you to add interactivity by adding standard css interactions such as hover: </p>
      
          <a href="#" class="button prev">Prev Page</a>
          <a href="#slide3" class="button next">Next Page</a>
        </div>
        <div id="page3">
          <h1>Interactivity</h1>
          <p>You can add javascript interactivity in the standard way either by events on the elements themselves or alternatively by adding event listeners to the DOM.</p>
          <a href="#slide2" class="button prev">Prev Page</a>
          <a href="#slide4" class="button next">Next Page</a>
        </div>
        <div id="page4">
          <h1>Limitations</h1>
          <ul>
            <li>All styles and images must be in the same origin or allow access via CORS; this allows the component to embed all of the assets required to render the html properly to the canvas via the foreignObject element. </li>
            <li>transform-style css is limited to flat. This is mainly due to it not being rendered properly to canvas so element bounding for preserve-3d has not yet been implemented. If the rendering is fixed as some point I may go back and get it working as well.</li>
            <li>"a-" tags do not render correctly as XHTML embeded into SVG, so any parent "a-" elements of the embed html will be converted to div tags for rendering. This may mean your css will require modification.</li>
            <li>Elements that require rendering outside of the DOM such as the iframe and canvas element will not work.
            <li>:before and :after pseudo elements can't be accessed via the DOM so they can't be used in the element to determine the object bounds. As such, use them with caution. </li>
            <li>Form elements are not consistently rendered to the canvas element so some basic default styles are included for consistency.</li>
            <li>Currently there is no support for css transitions.</li>
          </ul>
          <a href="#slide3" class="button prev">Prev Page</a>
        </div>
      </a-entity>




    </a-scene>
    </div>
    </div>
    </div>



      <!-------------------------------------------------------------------------------------------->

    <script>
      // Function to handle the start button click and display the A-Frame scene
      function loading() {
          document.querySelector(".start").style.display = "none"; // Hide the start button
          const aframe_container = document.getElementById("aframe");
          aframe_container.style.display = "block"; // Show the A-Frame container
          aframe_container.addEventListener('error', (e) => {
              console.error('Error loading screen', e)
          });

          // Show the A-Frame scene after the button is clicked
          const scene = document.querySelector('a-scene');
          scene.setAttribute("visible", "true"); // Make the scene visible
      }

      let current = "#hall_Nguyenlab";
      let map_right = new Map([["#Nguyen_lab#1", "#Nguyen_lab#2"], ["#Nguyen_lab#3", "#Nguyen_lab#1"]
          , ["#Nguyen_lab#2", "No_data"],
      ["#hall_Nguyenlab", "No_data"]]
      )
      let map_left = new Map([["#Nguyen_lab#1", "#Nguyen_lab#3"], ["#Nguyen_lab#3", "No_data"]
          , ["#Nguyen_lab#2", "#Nguyen_lab#1"]
          , ["#hall_Nguyenlab", "No_data"]]
      )
      let map_forward = new Map([["#Nguyen_lab#1", "No_data"], ["#Nguyen_lab#3", "No_data"]
          , ["#Nguyen_lab#2", "No_data"]
          , ["#hall_Nguyenlab", "#Nguyen_lab#1"]]
      )
      let map_back = new Map([["#Nguyen_lab#1", "No_data"], ["#Nguyen_lab#3", "No_data"]
          , ["#Nguyen_lab#2", "No_data"]
          , ["#Nguyen_lab#1", "#hall_Nguyenlab"]]
      )

      const arrow_right = document.getElementById("right");
      arrow_right.addEventListener('error', (e) => {
          console.error('Error loading arrow image', e);
      }); //debug 
      const arrow_left = document.getElementById("left");
      const arrow_forward = document.getElementById("forward");
      const arrow_back = document.getElementById("back");

      arrow_right.addEventListener("raycaster-intersected", (event) => {
          arrow_right.setAttribute("opacity", 1);
          arrow_left.setAttribute("opacity", 0.8);
          arrow_forward.setAttribute("opacity", 0.8);
          arrow_back.setAttribute("opacity", 0.8);
      })
      arrow_right.addEventListener("raycaster-intersected-cleared", (event) => {
          arrow_right.setAttribute("opacity", 0.8);
      })
      arrow_back.addEventListener("raycaster-intersected-cleared", (event) => {
          arrow_back.setAttribute("opacity", 0.8);
      })
      arrow_back.addEventListener("raycaster-intersected", (event) => {
          arrow_back.setAttribute("opacity", 1);
          arrow_right.setAttribute("opacity", 0.8);
          arrow_left.setAttribute("opacity", 0.8);
          arrow_forward.setAttribute("opacity", 0.8);


      })
      arrow_left.addEventListener("raycaster-intersected", (event) => {
          arrow_left.setAttribute("opacity", 1);
          arrow_back.setAttribute("opacity", 0.8);
          arrow_right.setAttribute("opacity", 0.8);
          arrow_forward.setAttribute("opacity", 0.8);
      })
      arrow_left.addEventListener("raycaster-intersected-cleared", (event) => {
          arrow_left.setAttribute("opacity", 0.8);
      })

      arrow_forward.addEventListener("raycaster-intersected", (event) => {
          arrow_right.setAttribute("opacity", 0.8);
          arrow_left.setAttribute("opacity", 0.8);
          arrow_forward.setAttribute("opacity", 1);
          arrow_back.setAttribute("opacity", 0.8);
      })
      arrow_forward.addEventListener("raycaster-intersected-cleared", (event) => {
          arrow_forward.setAttribute("opacity", 0.8);

      })

      // document.addEventListener("DOMContentLoaded", () => {
      //     // Function to change the sky's texture : ensure loaded all of the content, and make the function global
      //     function changeSky(skyId) {
      //         const sky = document.getElementById("sky");
      //         if (!sky) {
      //             console.error("Sky element not found!");
      //             return;
      //         }
      //         sky.setAttribute("src", skyId);
      //     }

      //     // Make the function globally accessible
      //     window.changeSky = changeSky;
      // })
      const info_icon = document.getElementById("infob");
      info_icon.addEventListener("raycaster-intersected", (event) => {
          console.log("Raycaster intersected with info_button");
          info_icon.setAttribute("opacity", 1);
          info_icon.setAttribute("scale", "0.13 0.13 0");
          document.querySelector('#infob').emit('trigger');


      })
      info_icon.addEventListener("raycaster-intersected-cleared", (event) => {
          info_icon.setAttribute("opacity", "0.8");
      })


      const close_icon = document.getElementById("closeb");
      close_icon.addEventListener("raycaster-intersected", (event)=>{
        console.log("Raycaster intersected with close_button");
          close_icon.setAttribute("opacity", 1);
          close_icon.setAttribute("scale", "0.13 0.13 0");
          document.querySelector('#closeb').emit('trigger');
      })

      close_icon.addEventListener("raycaster-intersected-cleared", (event) => {
          info_icon.setAttribute("opacity", "0.8");
      })

      const lang_icon = document.getElementById("langb");
      lang_icon.addEventListener("raycaster-intersected", (event)=>{
        console.log("Raycaster intersected with lang_button");
         lang_icon.setAttribute("opacity", 1);
          lang_icon.setAttribute("scale", "0.13 0.13 0");
          document.querySelector('#closeb').emit('trigger');
      })
      lang_icon.addEventListener("raycaster-intersected-cleared", (event) => {
          lang_icon.setAttribute("opacity", "0.8");
      })

  </script>
  </body>
</html>